<ion-view>
    <ion-content class="general-content has-header has-subheader">
        <div class="row">
            <div class="col">
                <h1 class="page-title">
                    {{'tax-information.tax_information' | translate}}
                </h1>
            </div>
        </div>
        <form name="taxInformationForm" novalidate>
            <div class="card">
                <div class="row">
                    <div class="col">
                        <div class="list">
                            <label class="item item-input item-select">
                                <div class="input-label">
                                    {{'tax-information.place_of_birth' | translate}}
                                </div>
                                <select name="placeOfBirth" ng-model="vm.data.placeOfBirth"
                                        ng-options="residence.value as residence.text for residence in vm.residenceList" required
                                        ng-disabled="vm.hasPlaceOfbirth">
                                    <option value="" disabled>{{'tax-information.select' | translate}}</option>
                                </select>
                            </label>
                            <div class="help-block error" ng-messages="taxInformationForm.placeOfBirth.$error"
                                 role="alert" ng-if='taxInformationForm.placeOfBirth.$dirty'
                                 ng-hide="vm.placeOfBirthError">
                                <div ng-message when="required">{{'tax-information.required' | translate}}</div>
                            </div>
                            <div class="help-block error" role="alert" ng-if='vm.placeOfBirthError'>
                                <div>{{vm.placeOfBirthErrorMessage}}</div>
                            </div>

                            <label class="item item-input item-select" ng-click="vm.showTaxResidenceItems()">
                                <div class="input-label">
                                    {{'tax-information.tax_residence' | translate}}
                                </div>
                                <div class="col item-input tax-residence">
                                    {{ vm.selectedTaxResidencesName || 'tax-information.select' | translate}}
                                </div>
                            </label>
                            <div class="help-block error" ng-if="vm.data.tax_residence  == null && vm.taxRequirement">
                                {{ 'tax-information.required' | translate }}
                            </div>

                            <label class="item item-input item-floating-label">
                                <span class="input-label">
                                  {{'tax-information.tax_identification_number' | translate}}
                                </span>
                                <input placeholder="{{'tax-information.tax_identification_number' | translate}}"
                                       name="taxIdentificationNumber" ng-model="vm.data.taxIdentificationNumber"
                                       ng-pattern="/^([a-zA-Z\d-\s])*$/" ng-minlength="0" ng-maxlength="20" required />
                            </label>
                            <ng-messages class="help-block error"
                                         for="taxInformationForm.taxIdentificationNumber.$error" role="alert"
                                         ng-if='taxInformationForm.taxIdentificationNumber.$dirty'
                                         ng-hide="vm.taxIdentificationNumberError">
                                <ng-message when="pattern">
                                    {{'tax-information.tax-identification-number-pattern-error' | translate}}
                                </ng-message>
                                <ng-message when="minlength, maxlength">
                                    {{'tax-information.maxlength_error_20' | translate}}
                                </ng-message>
                                <ng-message when="required"> {{'tax-information.required' | translate}} </ng-message>
                            </ng-messages>
                            <div class="help-block error" ng-if='vm.taxIdentificationNumberError'>
                                {{ vm.taxIdentificationNumberErrorMessage }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>

        <div class="row">
            <div class="col center">
                <span class="help-block error center" ng-if="vm.showNotChangedWarning">{{'tax-information.no_change' | translate}}</span>
                <button class="button button-positive" ng-click="vm.submitTaxInformation()" ng-disabled="taxInformationForm.$invalid || vm.data.taxResidence == null || vm.disableUpdateButton">{{'tax-information.update' | translate}}</button>
            </div>
        </div>
    </ion-content>
</ion-view>
